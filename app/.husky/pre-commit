#!/bin/sh

echo 'ğŸ‘·â€â™‚ï¸ Running pre-commit checks... Please wait.'

# Step 1: Check Prettier formatting
echo 'ğŸ” Checking Prettier formatting...'
if ! npm run check:format; then
  echo 'âŒ Code formatting issues detected by Prettier.'
  echo 'ğŸ”§ Automatically fixing issues with `npm run format`...'
  npm run format
  
  if ! npm run check:format; then
    echo 'âŒ Some formatting issues could not be fixed automatically. Please review manually.'
    exit 1
  else
    echo 'âœ… Formatting issues have been fixed. Proceeding with the commit...'
  fi
else
  echo 'âœ… Prettier checks passed!'
fi

# Step 2: Automatically fix ESLint issues (including unused imports)
echo 'ğŸ” Running ESLint to check and fix issues...'
if ! npm run lint:fix; then
  echo 'âŒ ESLint detected issues that could not be fixed automatically. Please fix them before committing.'
  exit 1
else
  echo 'âœ… ESLint checks passed! Unused imports removed (if any).'
fi

echo 'âœ… All checks passed! Proceeding with the commit...'
